<VirtualHost *:80>
    ServerName saturn-o.cloud
    ServerAlias www.saturn-o.cloud
    
    # Redirect all HTTP traffic to HTTPS
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}$1 [R=301,L]
    
    # Logs
    ErrorLog ${APACHE_LOG_DIR}/saturn-o-error.log
    CustomLog ${APACHE_LOG_DIR}/saturn-o-access.log combined
</VirtualHost>

<VirtualHost *:443>
    ServerName saturn-o.cloud
    ServerAlias www.saturn-o.cloud
    
    DocumentRoot /home/saturnoocloud/nodeapp
    
    # Passenger configuration
    PassengerEnabled on
    PassengerAppRoot /home/saturnoocloud/nodeapp
    PassengerAppType node
    PassengerStartupFile passenger.js
    PassengerNodejs /usr/bin/node
    
    # Environment
    PassengerAppEnv production
    SetEnv NODE_ENV production
    
    # Performance tuning
    PassengerMinInstances 2
    PassengerMaxPoolSize 6
    PassengerPoolIdleTime 300
    PassengerMaxRequests 1000
    
    # Memory limits
    PassengerMemoryLimit 512
    
    # SSL Configuration (will be added by certbot)
    SSLEngine on
    # SSLCertificateFile /etc/letsencrypt/live/saturn-o.cloud/fullchain.pem
    # SSLCertificateKeyFile /etc/letsencrypt/live/saturn-o.cloud/privkey.pem
    # Include /etc/letsencrypt/options-ssl-apache.conf
    
    # Logs
    ErrorLog ${APACHE_LOG_DIR}/saturn-o-error.log
    CustomLog ${APACHE_LOG_DIR}/saturn-o-access.log combined
    
    <Directory /home/saturnoocloud/nodeapp>
        Allow from all
        Options -MultiViews
        Require all granted
    </Directory>
</VirtualHost>
